name: Deploy to CIS web server

on:
    push:
        branches: ["main"]
    workflow_dispatch:

jobs:
    adjust_urls:
        runs-on: ubuntu-latest
        steps:
           - uses: actions/checkout@v3
             with:
                fetch-depth: 0
           - run: git branch
           - run: git fetch origin cis --depth 1
           - run: git checkout --progress --force -B cis refs/remotes/origin/cis
           - run: git branch
           - run: git merge main
           - uses: jacobtomlinson/gha-find-replace@v2
             with: 
                find: "http://localhost:8000"
                replace: "https://faculty.computing.gvsu.edu/kurmasz/"
                regex: false
           - run: git config user.name github-actions
           - run: git config user.email github-actions@github.com     
           - run: git add .
           - run: git commit -m 'substitute'
           - run: git branch
           - run: grep https index.html
    